% presentation.sty
% Custom style file for academic presentations
% Designed for research presentations with data visualizations

% Required packages
\RequirePackage{tikz}
\RequirePackage{xcolor}
\RequirePackage{graphicx}
\RequirePackage{amsfonts}
\RequirePackage{hyperref}
\RequirePackage{booktabs}
\RequirePackage{array}
\RequirePackage{multirow}
\RequirePackage{colortbl}

% Set theme base
\usetheme{Frankfurt}
\usecolortheme{default}
\useinnertheme{rectangles}
\usefonttheme{professionalfonts}

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}

% Define color scheme
\definecolor{primarycolor}{RGB}{24, 65, 112}        % Dark blue
\definecolor{secondarycolor}{RGB}{70, 130, 180}     % Steel blue
\definecolor{accentcolor}{RGB}{214, 123, 0}         % Orange
\definecolor{backgroundcolor}{RGB}{247, 250, 252}   % Light blue-gray
\definecolor{positivecolor}{RGB}{39, 174, 96}       % Green
\definecolor{negativecolor}{RGB}{231, 76, 60}       % Red
\definecolor{neutralcolor}{RGB}{189, 195, 199}      % Gray

% Apply colors to template elements
\setbeamercolor{palette primary}{fg=white,bg=primarycolor}
\setbeamercolor{palette secondary}{fg=white,bg=secondarycolor}
\setbeamercolor{palette tertiary}{fg=white,bg=primarycolor!80}
\setbeamercolor{palette quaternary}{fg=white,bg=primarycolor!60}

\setbeamercolor{structure}{fg=primarycolor}
\setbeamercolor{title}{fg=primarycolor}
\setbeamercolor{titlelike}{fg=primarycolor}
\setbeamercolor{frametitle}{fg=primarycolor,bg=backgroundcolor}
\setbeamercolor{subtitle}{fg=secondarycolor}
\setbeamercolor{block title}{fg=white,bg=primarycolor}
\setbeamercolor{block body}{fg=black,bg=backgroundcolor}

% Custom commands for highlighting text
\newcommand{\highlight}[1]{\textcolor{accentcolor}{#1}}
\newcommand{\positive}[1]{\textcolor{positivecolor}{#1}}
\newcommand{\negative}[1]{\textcolor{negativecolor}{#1}}

% Custom section page
\newcommand{\sectionpage}[1]{%
  \begin{frame}[plain]
    \begin{tikzpicture}[remember picture,overlay]
      % Background
      \fill[backgroundcolor] (current page.south west) rectangle (current page.north east);
      
      % Left accent bar
      \fill[primarycolor] ([xshift=0cm]current page.south west) rectangle ([xshift=1.5cm]current page.north west);
      
      % Horizontal line
      \draw[line width=3pt, secondarycolor] ([xshift=1.5cm,yshift=0cm]current page.west) -- ([xshift=-1.5cm]current page.east);
      
      % Section title
      \node[text width=\paperwidth-3cm, align=left] at ([xshift=4cm,yshift=0cm]current page.center) {
        {\LARGE\textcolor{primarycolor}{#1}}
      };
    \end{tikzpicture}
  \end{frame}
}

% Custom block styles
\setbeamertemplate{blocks}[rounded][shadow=false]

% Title page layout
\setbeamertemplate{title page}{%
  \begin{tikzpicture}[remember picture,overlay]
    % Background
    \fill[backgroundcolor] (current page.south west) rectangle (current page.north east);
    
    % Left accent bar
    \fill[primarycolor] ([xshift=0cm]current page.south west) rectangle ([xshift=1.5cm]current page.north west);
    
    % Title box
    \node[text width=\paperwidth-3cm, align=left] at ([xshift=4.5cm,yshift=2cm]current page.center) {
      {\LARGE\textcolor{primarycolor}{\inserttitle}}\\[0.5cm]
      {\large\textcolor{secondarycolor}{\insertsubtitle}}
    };
    
    % Author and institute
    \node[text width=\paperwidth-3cm, align=left] at ([xshift=4.5cm,yshift=-2cm]current page.center) {
      {\normalsize\insertauthor}\\[0.3cm]
      {\footnotesize\insertinstitute}
    };
  \end{tikzpicture}
}

% Footer with slide numbers and logo placeholder
\setbeamertemplate{footline}{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1.5ex,leftskip=0.5cm,rightskip=0.5cm]{palette quaternary}
    \insertshortauthor
    \hfill
    \insertframenumber\,/\,\inserttotalframenumber
  \end{beamercolorbox}
}

% Item and enumeration styling
\setbeamertemplate{itemize item}{\color{primarycolor}$\blacktriangleright$}
\setbeamertemplate{itemize subitem}{\color{secondarycolor}$\blacktriangleright$}
\setbeamertemplate{enumerate item}{\insertenumlabel.}
\setbeamertemplate{enumerate subitem}{\insertenumlabel.\insertsubenumlabel}

% Table styling
\newcommand{\headrow}{\rowcolor{primarycolor!25}}

% Custom environments
% Results table
\newenvironment{resultstable}[1][]{%
  \begin{table}[#1]
  \centering
  \rowcolors{2}{backgroundcolor}{white}
  \renewcommand{\arraystretch}{1.2}
}{%
  \end{table}
}

% Comparison blocks
\newenvironment{comparison}[0]{%
  \begin{columns}[T,onlytextwidth]
}{%
  \end{columns}
}

% Custom command for data point highlighting
\newcommand{\datapoint}[1]{%
  \begin{tikzpicture}[baseline=(text.base)]
    \node[draw=primarycolor, fill=backgroundcolor, thick, rounded corners=3pt, inner sep=2pt] (text) {#1};
  \end{tikzpicture}%
}

% Image frame
\newcommand{\imageframe}[2]{%
  \begin{tikzpicture}
    \node[draw=primarycolor!30, rounded corners, line width=1pt] {\includegraphics[width=#1]{#2}};
  \end{tikzpicture}%
}

% Better handling of graphics paths
\graphicspath{{./figures/}{./images/}{./}}

% Add progress bar in header
\makeatletter
\setbeamertemplate{headline}{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=0.4ex,dp=0ex]{palette primary}
    \begin{tikzpicture}
      \fill[primarycolor!50] (0,0) rectangle (\paperwidth,0.4ex);
      \fill[accentcolor] (0,0) rectangle (\paperwidth*\insertframenumber/\inserttotalframenumber,0.4ex);
    \end{tikzpicture}
  \end{beamercolorbox}
}
\makeatother